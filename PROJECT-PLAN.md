# PROJECT-PLAN.md - プロジェクト実装計画書

このファイルはTeam Task Manager Proの実装手順を管理するチェックリストです。
上から順番に実装し、完了毎にチェックを付けてプロジェクトの進捗を管理します。

**セッション引き継ぎ時の注意**:
このファイルを確認して、どこまで完了しているか把握してから開発を継続してください。

---

## 📊 進捗状況サマリー

- **全体進捗**: 約55% (Phase 1-3完了、Phase 4完了、Phase 5 Step 1-3完了、Phase 6完了)
- **完了Phase**: 5/16
- **完了ステップ**: Phase 4 Step 1-3/3 (完了), Phase 5 Step 1-3/4, Phase 6 Step 1-2/2 (完了)
- **現在のステップ**: Phase 4完了（タスク一覧ページの基本機能完成）
- **次のステップ候補**: Phase 5 Step 4 (担当者アサイン機能) (ユーザーと相談)

## 📋 段階的開発方針

**各Phaseはステップに分割され、段階的に実装します**:
- **Step 1 (最低限の機能)**: 各Phaseの最初のステップで基本動作を実現
- **Step 2 (基本機能)**: 実用的な機能を追加
- **Step 3以降 (拡張機能)**: さらなる機能拡張
- **柔軟な進行**: 各ステップ完了時、次のステップを続けるか別のPhaseに移るかをユーザーと相談

---

## Phase 1: プロジェクトセットアップ ✅

**状態**: ✅ 完了
**開始日**: 2026-01-18
**完了日**: 2026-01-18

### 実行項目

- [x] GitHubリポジトリ作成
  - [x] リポジトリ名: `Team-task-manager-pro`
  - [x] リポジトリURL: https://github.com/siesta-zumi/Team-task-manager-pro
  - [x] ローカルにクローン

- [x] Next.js 15プロジェクト初期化
  - [x] `npx create-next-app@latest` 実行
  - [x] TypeScript有効化
  - [x] App Router使用
  - [x] TailwindCSS v3設定
  - [x] ESLint設定

- [x] 依存関係のインストール
  - [x] `@supabase/supabase-js` インストール
  - [x] その他必要なパッケージ確認

- [x] 初回コミット・プッシュ
  - [x] `.gitignore` 設定確認
  - [x] 初回コミット作成
  - [x] `main` ブランチにプッシュ

**成果物**:
- ✅ 基本的なNext.jsプロジェクト構造
- ✅ package.json with 必要な依存関係
- ✅ TailwindCSS設定ファイル

---

## Phase 2: ドキュメント作成 ✅

**状態**: ✅ 完了
**開始日**: 2026-01-18
**完了日**: 2026-01-18

### 実行項目

- [x] README.md作成
  - [x] プロジェクト概要
  - [x] 技術スタック
  - [x] セットアップ手順
  - [x] 開発コマンド

- [x] CLAUDE.md作成（開発ルール）
  - [x] ディレクトリ構成
  - [x] コーディング規約
  - [x] Git コミットメッセージ規約
  - [x] よく使うコマンド一覧

- [x] docs/design.md作成（設計ドキュメント）
  - [x] 機能仕様
  - [x] データモデル（ER図）
  - [x] テーブル定義
  - [x] TypeScript型定義
  - [x] UI/UX設計（SharePoint風）

- [x] docs/session-handover.md作成
  - [x] プロジェクト概要
  - [x] 完了済みタスク一覧
  - [x] 既知の問題
  - [x] 次のステップ

- [x] ISSUE.md作成（不具合管理表）
  - [x] 現在の未解決課題
  - [x] Issue記録ルール
  - [x] フェーズ別Issue履歴

- [x] PROJECT-PLAN.md作成（このファイル）
  - [x] フェーズ別実装計画
  - [x] 実行項目チェックリスト

- [x] DEVELOPMENT-RULES.md作成（開発プロセスルール）
  - [x] 開発前の必須確認事項
  - [x] 問題発生時のルール
  - [x] Git運用ルール
  - [x] セッション引き継ぎルール

- [x] docs/FILE-STRUCTURE-GUIDE.md作成（ファイル構成ガイド）
  - [x] mdファイルの配置ルール
  - [x] ディレクトリ構成
  - [x] 判断フローチャート

- [x] docs/NOTIFICATION-GUIDE.md作成（通知機能ガイド）
  - [x] scripts/notify-completion.js作成
  - [x] クロスプラットフォーム対応（Windows/macOS/Linux）
  - [x] 4種類の通知音（success/question/error/info）
  - [x] デスクトップ通知機能

- [x] .env.local.example作成
  - [x] Supabase環境変数テンプレート
  - [x] Google GenAI APIキーテンプレート

- [x] CLAUDE.md更新
  - [x] AI運用5原則を冒頭に追加

**成果物**:
- ✅ 完全なプロジェクトドキュメント
- ✅ 開発ルールとコーディング規約
- ✅ 設計仕様書
- ✅ プロセスルールとファイル構成ガイド
- ✅ 音声通知システム

---

## Phase 3: Supabase基盤構築 ✅

**状態**: ✅ 完了
**開始日**: 2026-01-18
**完了日**: 2026-01-18

### 実行項目

- [x] Supabaseクライアント設定
  - [x] `lib/supabase.ts` 作成
  - [x] 環境変数設定（`.env.local.example`）
  - [x] createClient設定

- [x] TypeScript型定義
  - [x] `types/index.ts` - アプリケーション型定義
  - [x] `types/database.ts` - Supabase型定義
  - [x] Task, Member, Subtask, Assignment型

- [x] データベースマイグレーション
  - [x] `supabase/migrations/001_initial_schema.sql` 作成
    - [x] members テーブル
    - [x] tasks テーブル
    - [x] task_assignments テーブル
    - [x] subtasks テーブル
  - [x] `supabase/migrations/002_seed_data.sql` 作成
    - [x] サンプルメンバーデータ
    - [x] サンプルタスクデータ
    - [x] サンプル担当者データ
    - [x] サンプルチェックリストデータ

- [x] CRUD関数の実装
  - [x] `lib/tasks.ts` - タスク管理
    - [x] getTasks() - 全タスク取得
    - [x] getTaskById() - タスク詳細取得
    - [x] createTask() - タスク作成
    - [x] updateTask() - タスク更新
    - [x] deleteTask() - タスク削除
  - [x] `lib/members.ts` - メンバー管理
    - [x] getMembers() - 全メンバー取得
    - [x] getMemberById() - メンバー詳細取得
    - [x] createMember() - メンバー作成
    - [x] updateMember() - メンバー更新
  - [x] `lib/subtasks.ts` - チェックリスト管理
    - [x] getSubtasksByTaskId() - タスクのチェックリスト取得
    - [x] createSubtask() - チェックリスト作成
    - [x] updateSubtask() - チェックリスト更新
    - [x] deleteSubtask() - チェックリスト削除

**成果物**:
- ✅ Supabase接続設定
- ✅ 完全な型定義
- ✅ データベーススキーマ
- ✅ CRUD関数ライブラリ

**既知の問題**:
- 🟡 ISSUE-001: Supabase環境変数未設定エラー（回避策実装済み - プレースホルダー値で動作）

---

## Phase 4: タスク一覧ページ（3ステップ） ✅ 完了

**全体状態**: ✅ 完了
**開始日**: 2026-01-18
**完了日**: 2026-01-19

---

### Phase 4 Step 1: UI実装（最低限の機能） ✅ 完了

**開始日**: 2026-01-18
**完了日**: 2026-01-18

#### 実行項目

- [x] ホームページ作成
  - [x] `app/page.tsx` 修正
  - [x] タイトルと説明
  - [x] タスク一覧へのリンク

- [x] タスク一覧ページ（基本）
  - [x] `app/tasks/page.tsx` 作成（Server Component）
  - [x] getTasks()でデータ取得
  - [x] エラーハンドリング
  - [x] `export const dynamic = 'force-dynamic'` 設定

- [x] タスクテーブルコンポーネント
  - [x] `components/TaskTable.tsx` 作成（Client Component）
  - [x] SharePoint風のテーブルデザイン
  - [x] ステータス色分け（未着手/進行中/完了/承認済み）
  - [x] 担当者アバター表示（最大3名 + 残り人数）
  - [x] 進捗バー表示
  - [x] 業務スコア表示
  - [x] 日付フォーマット（MM/DD）
  - [x] 行のホバー効果
  - [x] クリックイベント（onTaskClick）

- [x] 統計情報カード
  - [x] 総タスク数
  - [x] 進行中タスク数
  - [x] 完了タスク数
  - [x] 平均進捗率

- [x] フィルター・検索UI
  - [x] ステータス選択ドロップダウン（UIのみ）
  - [x] 検索入力フィールド（UIのみ）

- [x] 新規タスクボタン
  - [x] ボタンUI作成

- [x] エラーハンドリング改善
  - [x] Supabase未接続時のフォールバック処理
  - [x] lib/supabase.tsにプレースホルダー値追加
  - [x] lib/tasks.tsのエラーハンドリング改善
  - [x] app/tasks/page.tsxのエラー表示改善
  - [x] console.errorをconsole.warnに変更（Supabase未接続時）

#### 成果物
- ✅ タスク一覧ページ（基本機能）
- ✅ SharePoint風テーブルコンポーネント
- ✅ 統計情報ダッシュボード

#### 動作確認結果
- ✅ ローカル環境（http://localhost:54112/tasks）で正常動作確認済み
- ✅ タスク一覧の表示が正常に動作
- ✅ タスクテーブルの表示が正常に動作
- ✅ 統計情報カードの表示が正常に動作

---

### Phase 4 Step 2: フィルター・検索機能（基本機能） ✅ 完了

**状態**: ✅ 完了
**開始日**: 2026-01-19
**完了日**: 2026-01-19

#### 実行項目

- [x] ステータスフィルターロジック
  - [x] app/tasks/page.tsxに状態管理追加（selectedStatus state）
  - [x] ステータス選択でフィルタリング実装（useMemoでメモ化）
  - [x] "すべて"オプション対応

- [x] タスク名検索ロジック
  - [x] 検索入力での部分一致検索実装（タイトル・説明文）
  - [x] リアルタイム検索（onChange即座に反映）
  - [x] 検索結果件数表示

- [x] フィルター結果の表示
  - [x] フィルタリング済みタスクの表示（TaskTableにfilteredTasks渡す）
  - [x] フィルター条件のクリアボタン

#### 成果物
- ✅ フィルター・検索機能（基本）
- ✅ ステータスフィルター（all, 未着手, 進行中, 完了, 承認済み）
- ✅ タスク検索（タイトル・説明文の部分一致）
- ✅ 検索結果件数表示
- ✅ フィルタークリア機能

#### 動作確認結果
- ✅ ステータスフィルターが正常に動作
- ✅ タスク検索が正常に動作（タイトル・説明文で検索可能）
- ✅ フィルター/検索の組み合わせが正常に動作
- ✅ 検索結果件数が正しく表示される
- ✅ フィルタークリアボタンが正常に動作

---

### Phase 4 Step 3: ソート・ページネーション（拡張機能） ✅ 完了

**状態**: ✅ 完了
**開始日**: 2026-01-19
**完了日**: 2026-01-19

#### 実行項目

- [x] ソート機能
  - [x] カラムヘッダークリックでソート
  - [x] タスク名、ステータス、期限日、進捗率でソート
  - [x] ソート方向切り替え（昇順/降順）
  - [x] ソート方向インジケーター（↑↓）

- [x] ページネーション
  - [x] ページサイズ選択（10, 25, 50, 100）
  - [x] ページ番号ボタン
  - [x] 前へ/次へボタン
  - [x] 総件数表示

- [ ] 状態永続化（将来実装予定）
  - [ ] URLクエリパラメータでフィルター/ソート/ページ状態保持
  - [ ] ブラウザバック/フォワード対応

#### 成果物
- ✅ ソート機能（タスク名、ステータス、期限日、進捗率）
- ✅ ページネーション（10/25/50/100件表示切替、ページ番号ボタン、前へ/次へボタン）
- ⏳ URL状態管理（Phase 7で実装予定）

#### 動作確認結果
- ✅ カラムヘッダークリックでソートが正常に動作
- ✅ ソート方向の切り替えが正常に動作（↑↓アイコン表示）
- ✅ ページサイズ選択が正常に動作
- ✅ ページ番号ボタンが正常に動作
- ✅ 前へ/次へボタンが正常に動作
- ✅ フィルター変更時に1ページ目に戻る動作が正常

---

## Phase 5: タスク詳細モーダル（4ステップ）

**全体状態**: 🔄 進行中（Phase 5 Step 1-3完了）
**開始日**: 2026-01-19

---

### Phase 5 Step 1: モーダルUI実装（最低限の機能） ✅ 完了

**開始日**: 2026-01-19
**完了日**: 2026-01-19

#### 実行項目

- [x] モーダルコンポーネント作成
  - [x] `components/TaskModal.tsx` 作成
  - [x] オーバーレイ背景、モーダルウィンドウ
  - [x] 閉じる機能（X、ESC、背景クリック）

- [x] app/tasks/page.tsx修正
  - [x] Server Component → Client Componentに変更
  - [x] モーダル開閉状態の管理
  - [x] TaskModalコンポーネント統合

- [x] components/TaskTable.tsx修正
  - [x] onTaskClickイベント実装
  - [x] タスク行クリックでtaskIdを親に通知

#### 成果物
- ✅ モーダルUIコンポーネント
- ✅ タスククリックでモーダルが開く機能

#### 動作確認結果
- ✅ タスク行クリックでモーダルが表示される
- ✅ Xボタン、ESCキー、背景クリックでモーダルが閉じる
- ✅ モーダル表示中はbodyスクロールが無効化される

---

### Phase 5 Step 2: タスク詳細表示・編集（基本機能） ✅ 完了

**開始日**: 2026-01-19
**完了日**: 2026-01-19

#### 実行項目

- [x] タスク詳細表示・編集フォーム
  - [x] タスク名、説明、ステータス、日付、スコア編集
  - [x] マニュアルリンク・フォルダリンク編集
  - [x] 繰り返し設定編集
  - [x] 保存・キャンセルボタン
  - [x] 保存中ローディング表示
  - [x] 保存成功/失敗のトースト通知

#### 成果物
- ✅ タスク詳細編集機能
- ✅ フォームバリデーション（タスク名必須、日付チェック、スコア範囲チェック）
- ✅ タスク更新後の一覧再取得機能

#### 動作確認結果
- ✅ タスク詳細がモーダルに表示される
- ✅ フォーム入力が正常に動作する
- ✅ バリデーションが機能する
- ✅ 保存が正常に動作する（モックデータ環境でも動作）
- ✅ 保存後にトースト通知が表示される
- ✅ 保存後にタスク一覧が自動更新される

---

### Phase 5 Step 3: チェックリスト機能（拡張機能） ✅ 完了

**開始日**: 2026-01-19
**完了日**: 2026-01-19

#### 実行項目

- [x] チェックリストCRUD
  - [x] チェックリスト表示（TaskModal内にUI追加）
  - [x] チェックリスト追加（入力フィールド + 追加ボタン）
  - [x] チェックリスト削除（削除ボタン）
  - [x] チェック状態のトグル（チェックボックス）
  - [x] 進捗率自動計算（完了数/総数×100）
  - [x] 進捗率表示（UI上に進捗率を表示）
  - [x] モックデータ環境対応（ローカルstateで管理）

#### 成果物
- ✅ チェックリスト機能（TaskModal内に実装）
- ✅ サブタスクのCRUD操作（追加、削除、チェック状態更新）
- ✅ 進捗率の自動計算（`recalculateTaskProgress`関数を使用）
- ✅ モックデータ環境での動作（ローカルstate管理）

#### 動作確認結果
- ✅ チェックリストが表示される
- ✅ サブタスクの追加が正常に動作する（モックデータ環境でも動作）
- ✅ サブタスクの削除が正常に動作する（モックデータ環境でも動作）
- ✅ チェック状態のトグルが正常に動作する（モックデータ環境でも動作）
- ✅ 進捗率が自動計算される（完了数/総数×100）
- ✅ 進捗率がUI上に表示される
- ✅ モックデータ環境でも動作する（ローカルstateで管理）

---

### Phase 5 Step 4: 担当者アサイン機能（拡張機能） ⏸️ 未着手

**状態**: ⏸️ 未着手

#### 実行項目

- [ ] 担当者アサイン
  - [ ] 担当者一覧表示、追加、削除
  - [ ] メイン/フォロー担当の区別
  - [ ] 負荷率表示（メイン100%、フォロー30%）

#### 成果物
- ⏳ 担当者アサイン機能

---

## Phase 6: 新規タスク作成（2ステップ）

**全体状態**: ✅ 完了
**開始日**: 2026-01-19
**完了日**: 2026-01-19

---

### Phase 6 Step 1: 新規作成UI（最低限の機能） ✅ 完了

**開始日**: 2026-01-19
**完了日**: 2026-01-19

#### 実行項目

- [x] 新規作成モーダル
  - [x] モーダルを新規作成モードで開く（taskId=null）
  - [x] フォーム初期値設定（ステータス: 未着手、開始日: 今日、終了日: 1週間後、スコア: 1）

#### 成果物
- ✅ 新規作成UI
- ✅ 新規作成モードのフォーム表示

#### 動作確認結果
- ✅ 新規タスクボタンでモーダルが開く
- ✅ フォームに初期値が設定される
- ✅ 新規作成モードと編集モードが正しく切り替わる

---

### Phase 6 Step 2: 作成機能実装（基本機能） ✅ 完了

**開始日**: 2026-01-19
**完了日**: 2026-01-19

#### 実行項目

- [x] タスク作成実行
  - [x] createTask() 実行
  - [x] バリデーション（タスク名必須、期限日>=開始日、スコア1-10）
  - [x] 保存成功/失敗のトースト通知
  - [x] 作成後のタスク一覧自動更新

#### 成果物
- ✅ タスク作成機能
- ✅ バリデーション機能
- ✅ 新規作成・更新の両方に対応した保存処理

#### 動作確認結果
- ✅ 新規タスクが正常に作成される（モックデータ環境でも動作）
- ✅ バリデーションが機能する
- ✅ 作成後にトースト通知が表示される
- ✅ 作成後にタスク一覧が自動更新される

---

## Phase 7-16: その他機能（詳細は後で展開）

以下のPhaseは、Phase 4-6完了後に詳細を展開します。

### Phase 7: フィルター・検索拡張（2ステップ）
- Phase 7 Step 1: 高度なフィルター（担当者、期限日、複数条件）
- Phase 7 Step 2: 状態永続化（URL、LocalStorage）

### Phase 8: ソート・ページネーション拡張（2ステップ）
- Phase 8 Step 1: 高度なソート（複数カラム、状態保存）
- Phase 8 Step 2: パフォーマンス最適化（useMemo、仮想スクロール）

### Phase 9: マニュアル機能（3ステップ）
- Phase 9 Step 1: マニュアルエディタUI（最低限の機能）
- Phase 9 Step 2: マニュアルCRUD機能（基本機能）
- Phase 9 Step 3: チェックリスト連動（拡張機能）

### Phase 10: チームダッシュボード（3ステップ）
- Phase 10 Step 1: ダッシュボードUI（最低限の機能）
- Phase 10 Step 2: メンバー別統計（基本機能）
- Phase 10 Step 3: 負荷可視化グラフ（拡張機能）

### Phase 11: カレンダー機能（3ステップ）- **凝った実装**

**全体状態**: ⏸️ 未着手
**優先度**: ⭐⭐⭐ 高（視覚的なタスク管理）

#### Phase 11 Step 1: カレンダーUI（最低限の機能）

**実行項目**:
- [ ] 月次/週次/日次ビューの切り替え
- [ ] ガントチャート形式のタイムライン表示
- [ ] タスクバーの表示（開始日〜終了日）
- [ ] ズームイン/アウト機能
- [ ] スクロール・ドラッグ操作
- [ ] カレンダーライブラリ選定（`react-big-calendar`、`@dhtmlx/gantt`、`react-gantt-chart`等）

**技術的検討事項**:
- ガントチャートライブラリの選定（パフォーマンス、カスタマイズ性を重視）
- レスポンシブ対応（モバイル・タブレット・デスクトップ）
- 大量タスクのパフォーマンス最適化（仮想スクロール）

#### Phase 11 Step 2: タスク表示（基本機能）

**実行項目**:
- [ ] タスクバーの色分け（ステータス別）
- [ ] 進捗率の可視化（バー内の進捗表示）
- [ ] 担当者のアバター表示
- [ ] タスクバークリックで詳細モーダル表示
- [ ] タスクバーのドラッグで日付変更
- [ ] 複数タスクの重複表示
- [ ] 依存関係の線表示（オプション）

**技術的検討事項**:
- ドラッグ&ドロップライブラリ（`react-dnd`、`@dnd-kit/core`等）
- 日付変更時のバリデーション（開始日 <= 終了日）
- リアルタイム更新（Supabase Realtime）

#### Phase 11 Step 3: 高度な機能（拡張機能）

**実行項目**:
- [ ] 承認ワークフロー統合
- [ ] フィルター機能（担当者、ステータス、タグ）
- [ ] 今日/今週/今月へのジャンプ機能
- [ ] 印刷機能（PDF/画像エクスポート）
- [ ] カスタムビュー保存
- [ ] タスクのグループ化（プロジェクト別、担当者別）

**技術的検討事項**:
- PDF生成ライブラリ（`jspdf`、`react-pdf`等）
- 画像エクスポート（`html2canvas`等）
- カスタムビューの保存（LocalStorage or Supabase）

### Phase 12: タスクリセット・アーカイブ（2ステップ）
- Phase 12 Step 1: リセット機能（最低限の機能）
- Phase 12 Step 2: アーカイブ管理（基本機能）

### Phase 13: AI機能統合（3ステップ）
- Phase 13 Step 1: Google GenAI設定（最低限の機能）
- Phase 13 Step 2: チェックリスト自動生成（基本機能）
- Phase 13 Step 3: 説明文清書（拡張機能）

### Phase 14: 認証機能（2ステップ、オプション）
- Phase 14 Step 1: Supabase Auth設定（最低限の機能）
- Phase 14 Step 2: RLSとセキュリティ（基本機能）

### Phase 15: テスト・品質保証（2ステップ）
- Phase 15 Step 1: 単体テスト（最低限の機能）
- Phase 15 Step 2: E2Eテスト（基本機能）

### Phase 16: デプロイ（2ステップ）
- Phase 16 Step 1: Vercelデプロイ（最低限の機能）
- Phase 16 Step 2: 本番環境整備（基本機能）

---

## 📋 ステータス管理の設計方針

### 「承認済み」ステータスの役割と使用想定

#### 基本的なステータス遷移フロー

```
未着手 → 進行中 → 完了 → 承認済み
```

#### 「承認済み」ステータスの位置づけ

**承認済みは「通過点」として機能します**。通常のタスク一覧では表示されず、承認後に自動処理が実行されます。

#### 承認後の自動処理

##### 1. 単発タスクの場合
```
完了 → 承認済み → アーカイブ（自動移動）
```
- 承認後、自動でアーカイブに移動
- 通常のタスク一覧から除外される
- アーカイブビューで履歴として確認可能

##### 2. 繰り返しタスクの場合
```
完了 → 承認済み → 次期間にリセット（未着手に戻る）
```
- 承認後、自動で次期間のタスクを生成
- 進捗率0%、ステータス「未着手」にリセット
- 元のタスクはアーカイブに移動（または履歴として保存）

#### タスク一覧での表示方針

| ステータス | 通常のタスク一覧 | アーカイブビュー | 説明 |
|-----------|----------------|----------------|------|
| 未着手 | ✅ 表示 | ❌ 非表示 | アクティブなタスク |
| 進行中 | ✅ 表示 | ❌ 非表示 | アクティブなタスク |
| 完了 | ✅ 表示 | ❌ 非表示 | 承認待ちのタスク |
| 承認済み | ❌ 非表示 | ✅ 表示 | 自動処理中（通過点） |
| アーカイブ | ❌ 非表示 | ✅ 表示 | 完了済みの履歴 |

#### 使用場面の具体例

##### 例1: 月次レポート作成タスク（繰り返し）
1. 担当者が「完了」に変更
2. 管理者が内容を確認
3. 問題なければ「承認済み」に変更
4. **システムが自動で次月のタスクを生成**（進捗0%、未着手）
5. 元のタスクはアーカイブに移動

##### 例2: プロジェクト完了タスク（単発）
1. 担当者が「完了」に変更
2. プロジェクトマネージャーが最終確認
3. 問題なければ「承認済み」に変更
4. **システムが自動でアーカイブに移動**
5. アーカイブビューで履歴として確認可能

#### 実装状況

- ✅ **ステータス定義**: 実装済み（`Status.Approved = '承認済み'`）
- ✅ **UI表示**: 実装済み（TaskTable、TaskModalで選択可能）
- ⏸️ **承認ワークフロー**: 未実装（Phase 11 Step 3で予定）
- ⏸️ **自動アーカイブ/リセット**: 未実装（Phase 12で予定）
- ⏸️ **アーカイブビュー**: 未実装（Phase 12 Step 2で予定）

#### 実装時の注意事項

1. **承認済みステータスのフィルタリング**
   - 通常のタスク一覧では「承認済み」をデフォルトで除外
   - オプションで「承認済みを含める」フィルタを提供（管理者向け）

2. **承認権限の管理**
   - 誰が承認できるか（管理者、上長、担当者等）の設定
   - Phase 14（認証機能）と連携

3. **自動処理のタイミング**
   - 承認済みに変更された瞬間に自動処理を実行
   - エラー時のロールバック機能

4. **アーカイブビューの設計**
   - 完了・承認済みのタスク履歴を表示
   - 検索・フィルタリング機能
   - 復元機能（オプション）

---

## 🗺️ ナビゲーション構成と実装予定

### アプリのコンセプト：自動化による管理

**このアプリの核となるコンセプト**:
- **マニュアルやサブタスクのチェックで全体の進捗が自動連動**
- **自動化による管理**が主眼（手動でのステータス変更を最小化）
- サブタスクのチェック → 進捗率自動計算 → ステータス自動更新
- マニュアルとサブタスクの連動による一元的な管理

**カンバン機能を削除した理由**:
- カンバンは「動かして管理する」（**手動管理**）機能
- コンセプトは「自動化による管理」のため、カンバンの手動操作は不要
- 一覧表での自動進捗管理で十分に目的を達成できる
- 開発リソースを自動化機能（サブタスク連動、マニュアル連動）に集中

### 現在の実装状況

画像に示されているナビゲーションバーは、以下の4つのビューで構成されています（カンバンは削除）：

| ビュー | パス | 実装状況 | 対応Phase |
|--------|------|---------|----------|
| **チームタスク** | `/tasks` | ✅ 実装済み | Phase 4 Step 1 |
| **マイタスク** | `/my-tasks` | ⏸️ 未実装 | Phase 4拡張 or Phase 22 |
| **負荷状況** | `/dashboard` | ⏸️ 未実装 | Phase 10 |
| **カレンダー** | `/calendar` | ⏸️ 未実装 | Phase 11（詳細実装予定） |
| ~~**カンバン**~~ | ~~`/kanban`~~ | ❌ **削除** | 不要のため実装しない |

### 実装予定の機能

#### 1. マニュアルページ設定
- **Phase**: Phase 9（マニュアル機能）
- **概要**: Notionライクなリッチエディタでマニュアルを作成・管理
- **詳細**: 
  - Phase 9 Step 1: マニュアルエディタUI
  - Phase 9 Step 2: マニュアルCRUD機能
  - Phase 9 Step 3: チェックリスト連動

#### 2. チーム・個人の別（マイタスク機能）
- **Phase**: Phase 4拡張 or Phase 22（新規追加）
- **概要**: ログインユーザーが担当しているタスクのみを表示
- **機能**:
  - 自分のタスクのみフィルタリング
  - 担当者別のタスク一覧
  - 個人の進捗状況表示

#### 3. 全体の負荷を把握できる機能（負荷状況ダッシュボード）
- **Phase**: Phase 10（チームダッシュボード）
- **概要**: メンバー別の負荷をグラフで可視化
- **詳細**:
  - Phase 10 Step 1: ダッシュボードUI
  - Phase 10 Step 2: メンバー別統計
  - Phase 10 Step 3: 負荷可視化グラフ（recharts使用）

#### 4. カレンダー表示機能（詳細実装予定）
- **Phase**: Phase 11（カレンダー機能）
- **概要**: ガントチャート形式でタスク期間を視覚的に表示（凝った実装）
- **詳細機能**:
  - **Phase 11 Step 1: カレンダーUI（最低限の機能）**
    - 月次/週次/日次ビューの切り替え
    - ガントチャート形式のタイムライン表示
    - タスクバーの表示（開始日〜終了日）
    - ズームイン/アウト機能
    - スクロール・ドラッグ操作
  - **Phase 11 Step 2: タスク表示（基本機能）**
    - タスクバーの色分け（ステータス別）
    - 進捗率の可視化（バー内の進捗表示）
    - 担当者のアバター表示
    - タスクバークリックで詳細モーダル表示
    - タスクバーのドラッグで日付変更
    - 複数タスクの重複表示
    - 依存関係の線表示（オプション）
  - **Phase 11 Step 3: 高度な機能（拡張機能）**
    - 承認ワークフロー統合
    - フィルター機能（担当者、ステータス、タグ）
    - 今日/今週/今月へのジャンプ機能
    - 印刷機能（PDF/画像エクスポート）
    - カスタムビュー保存
    - タスクのグループ化（プロジェクト別、担当者別）

### 実装優先度

1. **Phase 4 Step 2-3**: フィルター・検索、ソート・ページネーション（現在のタスク一覧の完成）
2. **Phase 5 Step 3-4**: チェックリスト、担当者アサイン（タスク詳細の完成）
3. **Phase 9**: マニュアル機能（差別化機能）
4. **Phase 10**: 負荷状況ダッシュボード（全体把握）
5. **Phase 11**: カレンダー機能（**凝った実装** - ガントチャート、複数ビュー、高度な操作）
6. **マイタスク機能**: Phase 4拡張 or Phase 22（個人管理）

### ナビゲーション実装の注意事項

- **共通レイアウト**: 全ページでナビゲーションバーを表示（`app/layout.tsx`で実装）
- **アクティブ状態**: 現在のビューをハイライト表示（画像の青いハイライト）
- **ルーティング**: Next.js App Routerを使用（`app/[view]/page.tsx`）
- **型定義**: `View`型（`'team' | 'my-tasks' | 'dashboard' | 'calendar'`）に更新（カンバン削除）

---

## 💡 将来の機能改善・追加アイデア

以下のアイデアは、ユーザーからの提案に基づいて実装可能性と重要度を評価したものです。
各アイデアは段階的に実装し、既存のPhaseと統合または新規Phaseとして追加します。

### 評価基準

- **実装可能性**: 🟢 容易（既存機能拡張） / 🟡 中程度（新規実装必要） / 🔴 困難（大規模変更）
- **重要度**: ⭐⭐⭐ 高（コア機能） / ⭐⭐ 中（利便性向上） / ⭐ 低（オプション）
- **依存関係**: 実装に必要な前提条件
- **推奨Phase**: 実装タイミングの提案

---

### アイデア1: サブタスク（チェックポイント）機能の強化

**概要**: タスクにサブタスク（チェックポイント）を追加する機能

**現状**: 
- ✅ 既に実装済み（`subtasks`テーブル、`lib/subtasks.ts`）
- 🔄 Phase 5 Step 3でチェックリスト機能として実装予定

**追加提案**:
- サブタスクの進捗率からタスクの`progress`を自動計算
- サブタスク完了時に通知機能

**実装可能性**: 🟢 容易（既存機能の拡張）
**重要度**: ⭐⭐⭐ 高（コア機能）
**依存関係**: Phase 5 Step 3完了後
**推奨Phase**: Phase 5 Step 3の拡張として実装

---

### アイデア2: マニュアルページ作成機能（Notionライク）

**概要**: マニュアルページを作成する機能。Notionのようなリッチエディタで、テキスト・動画・画像・テーブルを追加可能

**現状**: 
- 🔄 Phase 9でマニュアル機能として計画済み（詳細未展開）

**詳細要件**:
- リッチテキストエディタ（WYSIWYG）
- 画像・動画アップロード機能
- テーブル挿入機能
- マークダウン対応（オプション）

**実装可能性**: 🟡 中程度（リッチエディタライブラリ導入必要）
**重要度**: ⭐⭐⭐ 高（差別化機能）
**依存関係**: 
- ファイルストレージ（Supabase Storage推奨）
- リッチエディタライブラリ（例: TipTap、Lexical、Quill）
**推奨Phase**: Phase 9として詳細化（3-4ステップ）

**技術的検討事項**:
- エディタライブラリ選定（TipTap推奨：React 19対応、拡張性高）
- コンテンツ保存形式（JSON形式推奨：構造化データとして保存）
- 画像・動画のストレージ容量管理

---

### アイデア3: サブタスクとマニュアルの連携（H2自動反映）

**概要**: サブタスクの項目がマニュアルのH2として自動反映。H2と次のH2の間にテキストや画像を入れてマニュアルを肉付け

**詳細要件**:
- サブタスク追加時にマニュアルにH2として自動追加
- サブタスク削除時にマニュアルからH2を自動削除
- H2間のコンテンツ編集機能
- サブタスク順序変更時にマニュアルのH2順序も自動更新

**実装可能性**: 🟡 中程度（マニュアル機能実装後）
**重要度**: ⭐⭐⭐ 高（ユーザー体験向上）
**依存関係**: 
- アイデア2（マニュアル機能）完了必須
- アイデア1（サブタスク機能）完了必須
**推奨Phase**: Phase 9 Step 3として実装、またはPhase 17として新規追加

**技術的検討事項**:
- マニュアルコンテンツの構造化（H2とサブタスクのマッピング）
- 双方向同期（マニュアル編集→サブタスク反映の可否検討）

---

### アイデア4: チェック状態の双方向同期（マニュアル⇔サブタスク）

**概要**: サブタスクとマニュアルのチェック状態を双方向で同期させる機能
- **マニュアル側でチェック** → **タスク側のサブタスクにもチェックがつく**
- **タスク側のサブタスクにチェック** → **マニュアル側にもチェックがつく**（逆もしかり）

**詳細要件**:
- **双方向同期**:
  - マニュアルのH2セクション内のチェックボックスをクリック → 対応するサブタスクの`completed`フラグを更新
  - サブタスクの`completed`フラグ更新 → マニュアルの該当H2セクションのチェックボックスを更新
- サブタスク完了時にマニュアルの該当H2セクションに視覚的インジケーター表示
- 「次に確認すべき箇所」のハイライト機能
- 進捗状況の可視化（完了済み/未完了の色分け）

**実装可能性**: 🟡 中程度（マニュアル機能実装後）
**重要度**: ⭐⭐⭐ 高（**アプリのコンセプトの中核機能** - 自動化による管理）
**依存関係**: 
- アイデア2（マニュアル機能）完了必須
- アイデア3（H2自動反映）完了必須
**推奨Phase**: Phase 9 Step 3として実装、またはPhase 17 Step 1

**技術的検討事項**:

1. **データ構造の設計**
   - マニュアルコンテンツとサブタスクのマッピング（1対1の関係）
   - マニュアルのH2セクションIDとサブタスクIDの紐付けテーブル（`manual_subtask_mappings`）
   ```sql
   CREATE TABLE manual_subtask_mappings (
     id UUID PRIMARY KEY,
     task_id UUID NOT NULL REFERENCES tasks(id),
     subtask_id UUID NOT NULL REFERENCES subtasks(id),
     manual_section_id VARCHAR(100) NOT NULL, -- H2セクションのID
     UNIQUE(subtask_id, manual_section_id)
   );
   ```

2. **マニュアルコンテンツの構造化**
   - JSON形式でマニュアルコンテンツを保存（TipTapの`Document`型）
   - H2セクションにチェックボックスノードを埋め込み
   - チェックボックスに`subtask_id`を属性として保持

3. **同期ロジックの実装**
   - **マニュアル → サブタスク**: マニュアルエディタのチェックボックス変更イベントで`updateSubtask()`を呼び出し
   - **サブタスク → マニュアル**: サブタスク更新時のイベント（Supabase Realtime or ポーリング）でマニュアルエディタを更新
   - **循環更新の防止**: 更新フラグ（`isUpdatingFromManual`等）で無限ループを回避

4. **リアルタイム同期**
   - Supabase Realtimeを使用（`subtasks`テーブルの`completed`フラグ変更を監視）
   - またはポーリング（定期チェック）

5. **UI/UX設計**
   - マニュアルエディタ内のチェックボックスは、対応するサブタスクが存在する場合のみ表示
   - チェック状態の視覚的フィードバック（色分け、アニメーション）
   - 同期中のローディング表示

---

### アイデア5: 日付の自動更新（繰り返しタスク強化）

**概要**: タスクが更新されるときに自動で日付を更新（週次・月次）。土日祝日がある場合は後ろ倒し

**詳細要件**:
- 繰り返しタスクの開始日・終了日を自動更新
- 週次・月次・四半期・年次の自動計算
- 土日祝日の自動スキップ（後ろ倒し）
- 祝日カレンダー連携（日本の祝日対応）

**実装可能性**: 🟡 中程度（日付計算ロジック実装）
**重要度**: ⭐⭐ 中（運用効率化）
**依存関係**: 
- 繰り返し設定の拡張（アイデア8）完了推奨
- 祝日APIまたは祝日データベース
**推奨Phase**: Phase 12 Step 1の拡張、またはPhase 18として新規追加

**技術的検討事項**:
- 祝日データの取得方法（`@holiday-jp/holiday-jp`ライブラリ推奨）
- 日付計算ロジック（`date-fns`または`dayjs`使用）
- タイムゾーン対応

---

### アイデア6: 負荷スコアの見直し（タスクスコア）

**概要**: 「負荷スコア」という表現の見直し（「タスクスコア」など）。計算方法の検証、恣意性を排除するため管理者が設定するべきか検証

**詳細要件**:
- 名称変更: `score` → `task_score` または `complexity_score`
- 計算方法の見直し: `想定作業時間 × 重要度` を全体タスクと比較しての相対評価
- 管理者設定 vs 自動計算の検討
- UI表示の改善（スコアの意味を明確化）

**実装可能性**: 🟢 容易（既存フィールドの拡張）
**重要度**: ⭐⭐⭐ 高（UX改善、意思決定支援）
**依存関係**: なし（既存機能の改善）
**推奨Phase**: Phase 19として新規追加、またはPhase 4-6のリファクタリングとして実装

**技術的検討事項**:
- スコア計算式の設計（作業時間・重要度の入力方法）
- 相対評価の実装（全タスクのスコア分布から正規化）
- 管理者権限の実装（Phase 14認証機能と連携）

---

### アイデア7: ステータスの自動反映（進捗率連動）

**概要**: ステータスをサブタスクのチェック数による進捗率で自動反映させる。ステータス変更の手間を無くす工夫。最終的には手動変更を不要に

**詳細要件**:
- サブタスクの完了数から進捗率を自動計算
- 進捗率に基づいてステータスを自動更新
  - 0% → `未着手`
  - 1-99% → `進行中`
  - 100% → `完了`
- 手動ステータス変更のオプション（管理者権限）
- 進捗率とステータスの不一致検知・警告

**実装可能性**: 🟢 容易（既存機能の拡張）
**重要度**: ⭐⭐⭐ 高（運用効率化、データ整合性向上）
**依存関係**: 
- アイデア1（サブタスク機能）完了必須
- Phase 5 Step 3（チェックリスト機能）完了必須
**推奨Phase**: Phase 5 Step 3の拡張として実装、またはPhase 20として新規追加

**技術的検討事項**:
- 進捗率計算ロジック（サブタスクの`completed`フラグから集計）
- ステータス自動更新のトリガー（サブタスク更新時、バッチ処理）
- 手動変更との競合処理（優先順位の定義）

---

### アイデア8: 繰り返し設定の拡張

**概要**: 繰り返し設定の種類を見直し（毎日、週次、月次、四半期、年次、その他）

**現状**: 
- `RecurringType`は`None`と`Monthly`のみ実装済み

**詳細要件**:
- `RecurringType` Enumの拡張
  - `Daily` (毎日)
  - `Weekly` (週次)
  - `Monthly` (月次) - 既存
  - `Quarterly` (四半期)
  - `Yearly` (年次)
  - `Custom` (その他 - カスタム間隔設定)
- UIでの繰り返し設定選択肢の追加
- 繰り返しタスクの生成ロジック拡張

**実装可能性**: 🟢 容易（Enum拡張とUI更新）
**重要度**: ⭐⭐ 中（機能拡張）
**依存関係**: なし（既存機能の拡張）
**推奨Phase**: Phase 6の拡張として実装、またはPhase 21として新規追加

**技術的検討事項**:
- `RecurringType` Enumの型定義更新
- 繰り返しタスク生成ロジック（`date-fns`の`addDays`, `addWeeks`, `addMonths`等使用）
- カスタム間隔の設定UI設計

---

## 📊 アイデア実装優先度マトリックス

| アイデア | 実装可能性 | 重要度 | 依存関係 | 推奨実装順序 |
|---------|-----------|--------|---------|-------------|
| アイデア1: サブタスク強化 | 🟢 容易 | ⭐⭐⭐ 高 | Phase 5 Step 3 | **1** (Phase 5 Step 3拡張) |
| アイデア7: ステータス自動反映 | 🟢 容易 | ⭐⭐⭐ 高 | Phase 5 Step 3 | **2** (Phase 5 Step 3拡張) |
| アイデア6: 負荷スコア見直し | 🟢 容易 | ⭐⭐⭐ 高 | なし | **3** (Phase 19) |
| アイデア8: 繰り返し設定拡張 | 🟢 容易 | ⭐⭐ 中 | なし | **4** (Phase 6拡張 or Phase 21) |
| アイデア2: マニュアル機能 | 🟡 中程度 | ⭐⭐⭐ 高 | なし | **5** (Phase 9詳細化) |
| アイデア3: サブタスク-マニュアル連携 | 🟡 中程度 | ⭐⭐⭐ 高 | Phase 9, Phase 5 Step 3 | **6** (Phase 9 Step 3 or Phase 17) |
| アイデア4: チェック状態同期 | 🟡 中程度 | ⭐⭐ 中 | Phase 9, Phase 17 | **7** (Phase 17 Step 2) |
| アイデア5: 日付自動更新 | 🟡 中程度 | ⭐⭐ 中 | Phase 21 | **8** (Phase 12拡張 or Phase 18) |

---

### アイデア9: タスクテンプレート機能

**概要**: よく使うタスクのテンプレートを作成・保存し、テンプレートから素早くタスクを作成できる機能

**詳細要件**:
- テンプレート作成機能（タスク名、説明、デフォルトスコア、サブタスク、担当者等を保存）
- テンプレート一覧表示・検索
- テンプレートからタスク作成（一部項目を編集可能）
- テンプレートの共有機能（チーム全体 or 個人のみ）

**実装可能性**: 🟢 容易（既存タスク機能の拡張）
**重要度**: ⭐⭐⭐ 高（運用効率化、標準化）
**依存関係**: 
- Phase 5 Step 3（サブタスク機能）完了推奨
- Phase 5 Step 4（担当者アサイン機能）完了推奨
**推奨Phase**: Phase 22として新規追加

**技術的検討事項**:
- テンプレートテーブルの設計（`task_templates`テーブル）
- テンプレートからタスクへの変換ロジック
- テンプレートのバージョン管理（オプション）

---

### アイデア10: タスク依存関係管理

**概要**: タスク間の依存関係を設定し、「前提タスク完了後に開始可能」などの制約を管理

**詳細要件**:
- 依存関係の設定（前提タスク、後続タスク）
- 依存関係の可視化（グラフ表示）
- 前提タスク未完了時の警告表示
- 依存関係に基づく自動スケジューリング（オプション）

**実装可能性**: 🟡 中程度（グラフ可視化ライブラリ必要）
**重要度**: ⭐⭐ 中（プロジェクト管理の高度化）
**依存関係**: なし（独立機能）
**推奨Phase**: Phase 23として新規追加

**技術的検討事項**:
- 依存関係テーブルの設計（`task_dependencies`テーブル）
- 循環依存の検知・防止
- グラフ可視化ライブラリ（`react-flow`または`vis-network`推奨）
- トポロジカルソートによる順序計算

---

### アイデア11: タスク履歴・変更履歴（監査ログ）

**概要**: タスクの変更履歴を記録し、誰がいつ何を変更したかを追跡可能にする

**詳細要件**:
- タスクの全フィールド変更履歴の記録
- 変更者・変更日時の記録
- 変更履歴の表示（タイムライン形式）
- 変更前後の差分表示
- ロールバック機能（オプション）

**実装可能性**: 🟡 中程度（履歴テーブル設計必要）
**重要度**: ⭐⭐ 中（トレーサビリティ向上）
**依存関係**: 
- Phase 14（認証機能）完了推奨（変更者記録のため）
**推奨Phase**: Phase 24として新規追加

**技術的検討事項**:
- 履歴テーブルの設計（`task_history`テーブル）
- 変更差分の計算・表示
- 履歴データの容量管理（古い履歴のアーカイブ）

---

### アイデア12: バッチ操作（一括編集・一括削除）

**概要**: 複数のタスクを選択して一括で編集・削除・ステータス変更を行う機能

**詳細要件**:
- タスク一覧での複数選択（チェックボックス）
- 一括ステータス変更
- 一括担当者アサイン/解除
- 一括削除（確認ダイアログ付き）
- 一括日付更新

**実装可能性**: 🟢 容易（UI拡張のみ）
**重要度**: ⭐⭐⭐ 高（運用効率化）
**依存関係**: なし（既存機能の拡張）
**推奨Phase**: Phase 4 Step 2の拡張として実装、またはPhase 25

**技術的検討事項**:
- 選択状態の管理（`useState`で選択ID配列管理）
- バッチ更新APIの実装（`Promise.all`使用）
- 進捗表示（一括操作中のローディング）

---

### アイデア13: エクスポート/インポート機能

**概要**: タスクデータをCSV/Excel/JSON形式でエクスポート・インポートする機能

**詳細要件**:
- CSV形式でのエクスポート（Excel互換）
- JSON形式でのエクスポート（バックアップ用）
- CSV/JSONからのインポート
- インポート時のバリデーション・エラー表示
- 重複タスクの検知・処理

**実装可能性**: 🟡 中程度（CSV/Excelライブラリ必要）
**重要度**: ⭐⭐ 中（データ移行・バックアップ）
**依存関係**: なし（独立機能）
**推奨Phase**: Phase 26として新規追加

**技術的検討事項**:
- CSV処理ライブラリ（`papaparse`推奨）
- Excel処理ライブラリ（`xlsx`推奨）
- 大量データのストリーミング処理
- インポート時のトランザクション管理

---

### アイデア14: タグ機能

**概要**: タスクにタグを付与し、タグでフィルタリング・グループ化できる機能

**詳細要件**:
- タグの作成・管理（色分け対応）
- タスクへのタグ付与（複数タグ可）
- タグでのフィルタリング
- タグ別の統計表示
- タグの自動提案（既存タグから）

**実装可能性**: 🟢 容易（既存機能の拡張）
**重要度**: ⭐⭐ 中（分類・検索性向上）
**依存関係**: なし（独立機能）
**推奨Phase**: Phase 4 Step 2の拡張、またはPhase 27

**技術的検討事項**:
- タグテーブルの設計（`tags`、`task_tags`テーブル）
- タグ入力UI（オートコンプリート対応）
- タグの色管理（カラーピッカー）

---

### アイデア15: コメント・アクティビティフィード

**概要**: タスクにコメントを追加し、タスクのアクティビティ（変更、コメント等）を時系列で表示

**詳細要件**:
- タスクへのコメント追加・編集・削除
- @メンション機能（メンバーへの通知）
- アクティビティフィード（変更履歴 + コメント）
- リアルタイム更新（WebSocket or ポーリング）

**実装可能性**: 🟡 中程度（コメントテーブル設計必要）
**重要度**: ⭐⭐⭐ 高（コミュニケーション機能）
**依存関係**: 
- Phase 14（認証機能）完了推奨（コメント投稿者記録）
**推奨Phase**: Phase 28として新規追加

**技術的検討事項**:
- コメントテーブルの設計（`task_comments`テーブル）
- リアルタイム更新（Supabase Realtime使用）
- メンション機能の実装（`@username`パターン検出）

---

### アイデア16: ファイル添付機能

**概要**: タスクにファイル（画像、PDF、Excel等）を添付できる機能

**詳細要件**:
- ファイルアップロード（ドラッグ&ドロップ対応）
- ファイル一覧表示・ダウンロード
- 画像のプレビュー表示
- ファイルサイズ制限・容量管理
- ファイル削除機能

**実装可能性**: 🟡 中程度（Supabase Storage統合必要）
**重要度**: ⭐⭐⭐ 高（実用性向上）
**依存関係**: 
- Supabase Storage設定必須
**推奨Phase**: Phase 29として新規追加

**技術的検討事項**:
- Supabase Storageの設定・RLSポリシー
- ファイルアップロードUI（`react-dropzone`推奨）
- 画像プレビュー（`next/image`使用）
- ファイル容量管理・クォータ設定

---

### アイデア17: 通知機能の拡張

**概要**: タスクの期限接近、担当者変更、コメント追加などのイベントで通知を送信

**詳細要件**:
- 期限接近通知（1日前、3日前など設定可能）
- 担当者変更通知
- コメント追加通知
- タスク完了通知
- 通知設定（ON/OFF、通知方法選択）
- ブラウザ通知 + メール通知（オプション）

**実装可能性**: 🟡 中程度（通知システム構築必要）
**重要度**: ⭐⭐⭐ 高（タスク管理の実用性向上）
**依存関係**: 
- Phase 14（認証機能）完了推奨
- アイデア15（コメント機能）完了推奨
**推奨Phase**: Phase 30として新規追加

**技術的検討事項**:
- 通知テーブルの設計（`notifications`テーブル）
- ブラウザ通知API（`Notification API`）
- メール送信（Supabase Edge Functions or 外部サービス）
- 通知設定の管理（ユーザー別設定）

---

### アイデア18: 全文検索機能

**概要**: タスク名・説明・コメントなど、タスクに関連する全テキストを横断検索

**詳細要件**:
- 全文検索（PostgreSQLの`tsvector`使用 or 外部検索サービス）
- 検索結果のハイライト表示
- 検索履歴の保存
- 高度な検索オプション（AND/OR、除外キーワード）

**実装可能性**: 🟡 中程度（検索インデックス構築必要）
**重要度**: ⭐⭐ 中（検索性向上）
**依存関係**: 
- アイデア15（コメント機能）完了推奨（コメントも検索対象）
**推奨Phase**: Phase 4 Step 2の拡張、またはPhase 31

**技術的検討事項**:
- PostgreSQL全文検索（`tsvector`、`tsquery`）
- 検索インデックスの構築・更新
- 検索結果のランキング（関連度順）

---

### アイデア19: カスタムフィールド機能

**概要**: タスクにカスタムフィールド（数値、日付、選択肢等）を追加できる機能

**詳細要件**:
- カスタムフィールドの定義（フィールド名、型、必須/任意）
- カスタムフィールドの値入力
- カスタムフィールドでのフィルタリング・ソート
- カスタムフィールドの表示/非表示設定

**実装可能性**: 🔴 困難（スキーマ変更が必要、柔軟な設計必要）
**重要度**: ⭐ 低（高度なカスタマイズ機能）
**依存関係**: なし（独立機能）
**推奨Phase**: Phase 32（将来の拡張として検討）

**技術的検討事項**:
- JSONBカラムでのカスタムフィールド保存
- または`custom_fields`テーブルでの正規化設計
- 動的フォーム生成
- パフォーマンスへの影響評価

---

### アイデア20: タイムトラッキング（作業時間記録）

**概要**: タスクの作業時間を記録し、実績時間を管理する機能

**詳細要件**:
- 作業時間の記録（開始/終了、手動入力）
- 作業時間の集計（タスク別、メンバー別、日別）
- 作業時間の可視化（グラフ表示）
- 予定時間との比較（バーンダウンチャート）

**実装可能性**: 🟡 中程度（タイムトラッキングテーブル設計必要）
**重要度**: ⭐⭐ 中（プロジェクト管理の高度化）
**依存関係**: なし（独立機能）
**推奨Phase**: Phase 33として新規追加

**技術的検討事項**:
- タイムエントリーテーブルの設計（`time_entries`テーブル）
- 作業時間の集計クエリ（SUM、GROUP BY）
- タイムトラッキングUI（タイマー機能）

---

## 📊 追加アイデア実装優先度マトリックス

| アイデア | 実装可能性 | 重要度 | 依存関係 | 推奨実装順序 |
|---------|-----------|--------|---------|-------------|
| アイデア12: バッチ操作 | 🟢 容易 | ⭐⭐⭐ 高 | なし | **9** (Phase 4 Step 2拡張 or Phase 25) |
| アイデア16: ファイル添付 | 🟡 中程度 | ⭐⭐⭐ 高 | Supabase Storage | **10** (Phase 29) |
| アイデア15: コメント機能 | 🟡 中程度 | ⭐⭐⭐ 高 | Phase 14推奨 | **11** (Phase 28) |
| アイデア17: 通知拡張 | 🟡 中程度 | ⭐⭐⭐ 高 | Phase 14推奨 | **12** (Phase 30) |
| アイデア9: タスクテンプレート | 🟢 容易 | ⭐⭐⭐ 高 | Phase 5 Step 3-4推奨 | **13** (Phase 22) |
| アイデア14: タグ機能 | 🟢 容易 | ⭐⭐ 中 | なし | **14** (Phase 4 Step 2拡張 or Phase 27) |
| アイデア18: 全文検索 | 🟡 中程度 | ⭐⭐ 中 | アイデア15推奨 | **15** (Phase 4 Step 2拡張 or Phase 31) |
| アイデア11: 変更履歴 | 🟡 中程度 | ⭐⭐ 中 | Phase 14推奨 | **16** (Phase 24) |
| アイデア13: エクスポート/インポート | 🟡 中程度 | ⭐⭐ 中 | なし | **17** (Phase 26) |
| アイデア20: タイムトラッキング | 🟡 中程度 | ⭐⭐ 中 | なし | **18** (Phase 33) |
| アイデア10: 依存関係管理 | 🟡 中程度 | ⭐⭐ 中 | なし | **19** (Phase 23) |
| アイデア19: カスタムフィールド | 🔴 困難 | ⭐ 低 | なし | **20** (Phase 32 - 将来検討) |

---

## 📝 開発ガイドライン

### セッション引き継ぎ時の手順

1. **現状確認**
   - このファイル（PROJECT-PLAN.md）を確認
   - ISSUE.mdで未解決課題を確認
   - docs/session-handover.mdで全体状況を把握

2. **次のタスク選択**
   - 未完了（`[ ]`）のステップを上から順に実装
   - **各ステップ完了時**: ユーザーと相談して次のステップを続けるか、別のPhaseに移るかを決定
   - 依存関係に注意（Phase順推奨だが、優先度に応じて柔軟に変更可）

3. **実装開始**
   - 実装開始時に `[ ]` を `[x]` に変更
   - ステップのステータスを ⏸️ → 🔄 に更新
   - 問題発生時はISSUE.mdに記録

4. **完了報告**
   - ステップ完了時に状態を 🔄 → ✅ に更新
   - Phase全体完了時に全体状態を ✅ に更新
   - docs/session-handover.mdも更新
   - **ユーザーに次のステップを相談**

### チェックボックスの使い方

- `[ ]` 未着手
- `[x]` 完了
- `[~]` 部分完了（一部のみ実装済み）

### Phase状態の意味

- ⏸️ **未着手**: まだ開始していない
- 🔄 **進行中**: 現在作業中
- ✅ **完了**: すべての項目が完了
- ⚠️ **保留**: 問題により一時停止中

---

## 🔗 関連ドキュメント

- [README.md](README.md) - プロジェクト概要
- [CLAUDE.md](CLAUDE.md) - 開発ルール
- [DEVELOPMENT-RULES.md](DEVELOPMENT-RULES.md) - 開発プロセスルール
- [docs/design.md](docs/design.md) - 設計ドキュメント
- [docs/session-handover.md](docs/session-handover.md) - セッション引き継ぎ情報
- [docs/FILE-STRUCTURE-GUIDE.md](docs/FILE-STRUCTURE-GUIDE.md) - ファイル構成ガイド
- [docs/NOTIFICATION-GUIDE.md](docs/NOTIFICATION-GUIDE.md) - 通知機能ガイド
- [ISSUE.md](ISSUE.md) - 不具合管理表

---

*最終更新: 2026-01-19 (カンバン機能削除、カレンダー機能の詳細実装計画を拡充、ナビゲーション構成と実装予定を追加、承認済みステータスの役割と使用想定を明確化、追加機能アイデア12件を追加 - 合計20件のアイデア)*
*管理者: Claude Sonnet 4.5*
